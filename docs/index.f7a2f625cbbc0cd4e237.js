(()=>{"use strict";class e{constructor(e){this._name=e,this._role="user"}get name(){return this._name}get role(){return this._role}}class t extends e{constructor(e){super(e),this._role="admin"}}const n=["Jhon","Mila","Sam","Molly","Garry","Lisa","Mike"],o=[];for(let r=0;r<n.length;r+=1)r<3?o.push(new t(n[r])):o.push(new e(n[r]));const r=o,s=My$.modal({content:`\n    <p>Please, authorise</p>\n    <p id="role"></p>\n    <select class="form-select form-select-lg mb-3" id="auth-select">\n        <option selected>Select a name</option>\n        ${(()=>{let e="";for(const t of r)e+=`<option value="${t.name}">${t.name}</option>\n\t`;return e})()}\n    </select>\n    <div class="modal-buttons">\n        <button type="button" class="btn btn-primary" id="confirm">Confirm</button>\n    </div>\n  `});let c;const a=document.getElementById("checkBoxes"),l=document.querySelectorAll("td"),d=My$.modal({content:'\n    <p>Are You sure You want to delete "Retrospective" event?</p>\n    <div class="modal-buttons">\n      <button type="button" class="btn btn-danger" id="yes">Yes</button>\n      <button type="button" class="btn btn-outline-dark" id="no">No!</button>\n    </div>\n  '});window.addEventListener("load",(()=>{const e=indexedDB.open("calendar",1);function t(e){const{currentTarget:t}=e,{target:n}=e;d.open();const o=document.querySelector("#yes"),r=document.querySelector("#no");o.addEventListener("click",(()=>{const e=Number(t.parentNode.getAttribute("id").match(/\d+/)),o=c.transaction(["events"],"readwrite");o.objectStore("events").delete(e),o.oncomplete=()=>{n.parentNode.remove()},d.close()})),r.addEventListener("click",(()=>{d.close()}))}function n(e){const n=[];document.querySelectorAll('input[type="checkbox"]:checked').forEach((e=>{const t=document.querySelector(`label[for="${e.id}"`);n.push(t.textContent.trim())}));c.transaction("events").objectStore("events").openCursor().onsuccess=o=>{const r=o.target.result;if(r){const{participants:o}=r.value;if("all"===e||My$.arrCompare(o,n)){const e=`td[headers="${r.value.dayTime}"]`,n=document.querySelector(e),o=document.createElement("div"),s=document.createElement("span"),c=document.createElement("span");o.setAttribute("id",`event-${r.value.id}`),o.setAttribute("draggable","true"),c.innerHTML="&times;",s.textContent=r.value.name,n.appendChild(o),o.appendChild(s),o.appendChild(c),o.classList.add("td-content"),c.classList.add("td__delete-btn"),c.addEventListener("click",t)}r.continue()}}}e.onupgradeneeded=()=>{c=e.result;const t=c.createObjectStore("events",{keyPath:"id",autoIncrement:!0});t.createIndex("name","name",{unique:!1}),t.createIndex("participants","participants",{unique:!1}),t.createIndex("dayTime","dayTime",{unique:!0}),console.log("Database setup complete")},e.onerror=()=>{console.error("Error",e.error)},e.onsuccess=()=>{function t(e){e.preventDefault()}function o(e){e.dataTransfer.setData("headers",e.currentTarget.getAttribute("headers"))}function d(e){const t=e.dataTransfer.getData("headers");e.target.appendChild(document.querySelector(`td[headers="${t}"]`).firstChild);const n=c.transaction(["events"],"readwrite"),o=n.objectStore("events"),r=o.index("dayTime").get(t);r.onsuccess=()=>{const t=r.result;t.dayTime=e.target.getAttribute("headers");o.put(t).onsuccess=()=>{console.log("DayTime is update!")}},n.oncomplete=()=>{console.log("Complete!")}}console.log("Database opened succesfully"),c=e.result,n("all"),a.addEventListener("closebox",(()=>{l.forEach((e=>{e.firstChild&&e.firstChild.remove()})),n()}),!1),l.forEach((e=>{e.addEventListener("dragover",t),e.addEventListener("dragstart",o),e.addEventListener("drop",d)})),s.open();const i=document.querySelector("#auth-select"),u=()=>{const e=document.querySelector("#auth-select>option:checked").value;let t;return"Select a name"!==e&&(t=r.find((t=>t.name===e&&t))),t};i.onchange=()=>{document.getElementById("role").innerText=`Role: ${u()?u().role:""}`};document.querySelector("#confirm").onclick=()=>{let e;if(u()&&(e=u().role,s.close()),"user"===e){document.querySelector("#new-event-btn").style.display="none",document.querySelector(".select-names").style.marginRight=0,l.forEach((e=>{e.removeEventListener("dragover",t),e.removeEventListener("dragstart",o),e.removeEventListener("drop",d)}));const e=document.querySelectorAll(".td__delete-btn");console.log(e);for(const t of e)t.style.display="none"}}}}))})();