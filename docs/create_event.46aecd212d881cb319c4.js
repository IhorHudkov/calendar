(()=>{"use strict";const e=document.forms.eventForm,t=e.name,o=e.day,n=e.time;let r;window.onload=function(){let a=indexedDB.open("calendar",1);a.onupgradeneeded=function(){r=a.result;let e=r.createObjectStore("events",{keyPath:"id",autoIncrement:!0});e.createIndex("name","name",{unique:!1}),e.createIndex("participants","participants",{unique:!1}),e.createIndex("dayTime","dayTime",{unique:!0}),console.log("Database setup complete")},a.onerror=function(){console.error("Error",a.error)},a.onsuccess=function(){console.log("Database opened succesfully"),r=a.result},e.onsubmit=e=>{e.preventDefault();const a=document.querySelectorAll('input[type="checkbox"]:checked'),c=[];for(let e of a){let t=document.querySelector(`label[for="${e.id}"`);c.push(t.textContent.trim())}let l={name:t.value,participants:c,dayTime:`${o.value} ${n.value}`},i=r.transaction(["events"],"readwrite");i.objectStore("events").add(l).onsuccess=function(){t.value="",o.value="Choose...",n.value="Choose..."},i.oncomplete=function(){console.log("Transaction completed: database modification finished."),window.location.href="index.html"},i.onerror=function(){document.querySelector(".error-msg").setAttribute("style","display: block;"),console.log("Transaction not opened due to error")}}}})();