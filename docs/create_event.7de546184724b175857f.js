(()=>{"use strict";const e=document.forms.eventForm,o=e.name,t=e.day,n=e.time;let r;window.onload=()=>{const a=indexedDB.open("calendar",1);a.onupgradeneeded=()=>{r=a.result;const e=r.createObjectStore("events",{keyPath:"id",autoIncrement:!0});e.createIndex("name","name",{unique:!1}),e.createIndex("participants","participants",{unique:!1}),e.createIndex("dayTime","dayTime",{unique:!0}),console.log("Database setup complete")},a.onerror=()=>{console.error("Error",a.error)},a.onsuccess=()=>{console.log("Database opened succesfully"),r=a.result},e.onsubmit=e=>{e.preventDefault();const a=document.querySelectorAll('input[type="checkbox"]:checked'),c=[];a.forEach((e=>{const o=document.querySelector(`label[for="${e.id}"`);c.push(o.textContent.trim())}));const s={name:o.value,participants:c,dayTime:`${t.value} ${n.value}`},l=r.transaction(["events"],"readwrite");l.objectStore("events").add(s).onsuccess=()=>{o.value="",t.value="Choose...",n.value="Choose..."},l.oncomplete=()=>{console.log("Transaction completed: database modification finished."),window.location.href="index.html"},l.onerror=()=>{document.querySelector(".error-msg").setAttribute("style","display: block;"),console.log("Transaction not opened due to error")}}}})();