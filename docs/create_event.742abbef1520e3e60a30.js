(()=>{"use strict";const e=document.forms.eventForm,o=e.name,t=e.day,r=e.time;let n;window.onload=()=>{const s=indexedDB.open("calendar",1);s.onupgradeneeded=()=>{n=s.result;const e=n.createObjectStore("events",{keyPath:"id",autoIncrement:!0});e.createIndex("name","name",{unique:!1}),e.createIndex("participants","participants",{unique:!1}),e.createIndex("dayTime","dayTime",{unique:!0}),console.log("Database setup complete")},s.onerror=()=>{console.error("Error",s.error)},s.onsuccess=()=>{console.log("Database opened succesfully"),n=s.result},e.onsubmit=e=>{if(e.preventDefault(),!(o.value.trim()?(o.classList.remove("input-error"),1):(o.classList.add("input-error"),0))|!("Choose..."===t.value?(t.classList.add("input-error"),0):(t.classList.remove("input-error"),1))|!("Choose..."===r.value?(r.classList.add("input-error"),0):(r.classList.remove("input-error"),1)))return;const s=document.querySelectorAll('input[type="checkbox"]:checked'),a=[];s.forEach((e=>{const o=document.querySelector(`label[for="${e.id}"`);a.push(o.textContent.trim())}));const c={name:o.value,participants:a,dayTime:`${t.value} ${r.value}`},i=n.transaction(["events"],"readwrite");i.objectStore("events").add(c).onsuccess=()=>{o.value="",t.value="Choose...",r.value="Choose..."},i.oncomplete=()=>{console.log("Transaction completed: database modification finished."),window.location.href="index.html"},i.onerror=()=>{document.querySelector(".error-msg").setAttribute("style","display: block;"),console.log("Transaction not opened due to error")}}}})();