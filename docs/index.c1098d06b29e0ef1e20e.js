(()=>{"use strict";class e{constructor(e){this._name=e,this._role="user"}get name(){return this._name}get role(){return this._role}}class t extends e{constructor(e){super(e),this._role="admin"}}const n=["Jhon","Mila","Sam","Molly","Garry","Lisa","Mike"],o=[];for(const r of n){Math.floor(2*Math.random())?o.push(new t(r)):o.push(new e(r))}const r=o,s=My$.modal({content:`\n    <p>Please, authorise</p>\n    <select class="form-select form-select-lg mb-3" id="auth-select">\n        <option selected>Select a name</option>\n        ${(()=>{let e="";for(const t of r)e+=`<option value="${t.name}">${t.name}</option>\n\t`;return e})()}\n    </select>\n    <div class="modal-buttons">\n        <button type="button" class="btn btn-primary" id="confirm">Confirm</button>\n    </div>\n  `});let a;const c=document.getElementById("checkBoxes"),d=document.querySelectorAll("td"),l=My$.modal({content:'\n    <p>Are You sure You want to delete "Retrospective" event?</p>\n    <div class="modal-buttons">\n      <button type="button" class="btn btn-danger" id="yes">Yes</button>\n      <button type="button" class="btn btn-outline-dark" id="no">No!</button>\n    </div>\n  '});window.addEventListener("load",(()=>{s.open();document.querySelector("#confirm").onclick=()=>{const e=document.querySelector("#auth-select>option:checked").value;let t;"Select a name"!==e&&(t=r.find((t=>t.name===e&&t)).role,console.log(t),s.close()),"user"===t&&(document.querySelector("#new-event-btn").style.display="none",document.querySelector(".select-names").style.marginRight=0)};const e=indexedDB.open("calendar",1);function t(e){const{currentTarget:t}=e,{target:n}=e;l.open();const o=document.querySelector("#yes"),r=document.querySelector("#no");o.addEventListener("click",(()=>{const e=Number(t.parentNode.getAttribute("id").match(/\d+/)),o=a.transaction(["events"],"readwrite");o.objectStore("events").delete(e),o.oncomplete=()=>{n.parentNode.remove()},l.close()})),r.addEventListener("click",(()=>{l.close()}))}function n(e){const n=[];document.querySelectorAll('input[type="checkbox"]:checked').forEach((e=>{const t=document.querySelector(`label[for="${e.id}"`);n.push(t.textContent.trim())}));a.transaction("events").objectStore("events").openCursor().onsuccess=o=>{const r=o.target.result;if(r){const{participants:o}=r.value;if("all"===e||My$.arrCompare(o,n)){const e=`td[headers="${r.value.dayTime}"]`,n=document.querySelector(e),o=document.createElement("div"),s=document.createElement("span"),a=document.createElement("span");o.setAttribute("id",`event-${r.value.id}`),o.setAttribute("draggable","true"),a.innerHTML="&times;",s.textContent=r.value.name,n.appendChild(o),o.appendChild(s),o.appendChild(a),o.classList.add("td-content"),a.classList.add("td__delete-btn"),a.onclick=t}r.continue()}}}e.onupgradeneeded=()=>{a=e.result;const t=a.createObjectStore("events",{keyPath:"id",autoIncrement:!0});t.createIndex("name","name",{unique:!1}),t.createIndex("participants","participants",{unique:!1}),t.createIndex("dayTime","dayTime",{unique:!0}),console.log("Database setup complete")},e.onerror=()=>{console.error("Error",e.error)},e.onsuccess=()=>{function t(e){e.preventDefault()}function o(e){e.dataTransfer.setData("headers",e.currentTarget.getAttribute("headers"))}function r(e){const t=e.dataTransfer.getData("headers");e.target.appendChild(document.querySelector(`td[headers="${t}"]`).firstChild);const n=a.transaction(["events"],"readwrite"),o=n.objectStore("events"),r=o.index("dayTime").get(t);r.onsuccess=()=>{const t=r.result;t.dayTime=e.target.getAttribute("headers");o.put(t).onsuccess=()=>{console.log("DayTime is update!")}},n.oncomplete=()=>{console.log("Complete!")}}console.log("Database opened succesfully"),a=e.result,n("all"),c.addEventListener("closebox",(()=>{d.forEach((e=>{e.firstChild&&e.firstChild.remove()})),n()}),!1),d.forEach((e=>{e.addEventListener("dragover",t),e.addEventListener("dragstart",o),e.addEventListener("drop",r)}))}}))})();