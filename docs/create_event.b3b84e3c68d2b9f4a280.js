(()=>{"use strict";class t{constructor(t){this._event=t}_postOptions(){return{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:`{"data": "${JSON.stringify(this._event).replace(/"/g,'\\"')}"}`}}static async getAllEvents(){const t=await fetch("http://158.101.166.74:8080/api/data/ihor_hudkov/events");return await t.json()}static async getEventByDayTime(e){return t.getAllEvents().then((t=>{let a;for(const o of t)if(JSON.parse(o.data).dayTime===e){a=o;break}return a}))}async createEvent(){const e=await t.getAllEvents();if(e)for(const t of e)if(JSON.parse(t.data).dayTime===this._event.dayTime)throw new Error("Failed to create an event. Time slot is already booked.");const a=await fetch("http://158.101.166.74:8080/api/data/ihor_hudkov/events",this._postOptions());return await a.json()}static async deleteEvent(t){return(await fetch(`http://158.101.166.74:8080/api/data/ihor_hudkov/events/${t}`,{method:"DELETE"})).ok}static async updateEvent(t,e){return(await fetch(`http://158.101.166.74:8080/api/data/ihor_hudkov/events/${t}`,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:`{"data": "${JSON.stringify(e).replace(/"/g,'\\"')}"}`})).ok}}const e=document.forms.eventForm,a=e.name,o=e.day,s=e.time;window.onload=()=>{e.onsubmit=e=>{if(e.preventDefault(),!(a.value.trim()?(a.classList.remove("input-error"),1):(a.classList.add("input-error"),0))|!("Choose..."===o.value?(o.classList.add("input-error"),0):(o.classList.remove("input-error"),1))|!("Choose..."===s.value?(s.classList.add("input-error"),0):(s.classList.remove("input-error"),1)))return;const r=document.querySelectorAll('input[type="checkbox"]:checked'),n=[];r.forEach((t=>{const e=document.querySelector(`label[for="${t.id}"`);n.push(e.textContent.trim())}));const i={name:a.value,participants:n,dayTime:`${o.value} ${s.value}`};new t(i).createEvent().then((()=>{a.value="",o.value="Choose...",s.value="Choose...",alert("Event was successfully added to the calendar"),window.location.href="index.html"}),(t=>{console.log(t.message);document.querySelector(".error-msg").setAttribute("style","display: block;")}))}}})();